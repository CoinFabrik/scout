<style>
    .code-snippet-container {
        position: relative;
        padding-left: 4rem;
        overflow-y: hidden;
    }

    .code-snippet-container .code-line {
        position: relative;
        counter-increment: line;
        padding: 0.25rem 0.5rem;
        display: block;
        background-color: #2D3748;
    }

    .code-snippet-container .code-line:before {
        content: counter(line);
        position: absolute;
        left: 0;
        padding: 0 10px;
        text-align: center;
        width: 3rem;
        margin-left: -3.5rem;
        background-color: #1A202C;
        color: #4A5568;
        box-sizing: border-box;
    }

    .code-line:hover {
        background-color: #334155;
    }

    .code-snippet-container {
        background-color: #1A202C;
        border-radius: 0.375rem;
    }
</style>



<div id="vulnerabilityDetails" class="p-4 max-w-4xl mx-auto bg-gray-800 rounded-lg text-gray-100">
    {% for finding in report.findings %}
    {% set category = report.categories | filter(attribute="id", value=finding.category_id) | first %}
    {% set vulnerability = category.vulnerabilities | filter(attribute="id", value=finding.vulnerability_id) | first %}
    <div id="detail-{{ finding.id }}"
        class="shadow-lg overflow-hidden p-6 my-4 bg-gradient-to-r from-gray-700 to-gray-900 rounded-lg space-y-4 hidden">
        <div class="flex justify-between items-center">
            <h3 class="text-xl font-bold text-blue-400">{{ category.name }} - {{ vulnerability.name }}</h3>
            <span
                class="px-3 py-1  rounded-full text-gray-900 font-semibold {{ 'severity-' ~ vulnerability.severity | lower }}">Severity:
                {{
                vulnerability.severity | upper }}</span>
        </div>
        <p class="text-gray-300">{{ vulnerability.short_message }}</p>
        <p class="text-gray-400">{{ vulnerability.long_message }}</p>
        <p class="text-gray-400">Source: <span class="font-mono text-gray-200">{{ finding.file }}</span></p>
        <p class="text-gray-400">Span: <span class="font-mono text-gray-200">{{ finding.span }}</span></p>

        <div class="code-snippet-container bg-gray-800 rounded overflow-auto font-mono text-green-400" data-lines="">
            {% for line in finding.code_snippet | split(pat="\n") %}
            <div class="code-line">{{ line }}</div>
            {% endfor %}
        </div>
        <p class="text-gray-400">Error message: <span class="font-mono text-gray-200">{{ finding.error_message }}</span>
        </p>
        <p>
            Learn more about:
            <a href="{{ vulnerability.help }}"
                class="inline-block bg-blue-500 hover:bg-blue-600 text-blue-100 font-semibold px-3 py-1 rounded transition duration-150 ease-in-out">{{
                vulnerability.name }}</a>
        </p>
    </div>
    {% endfor %}
</div>