<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-vulnerabilities/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Vulnerabilities | Scout</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://coinfabrik.github.io/scout/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://coinfabrik.github.io/scout/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://coinfabrik.github.io/scout/docs/vulnerabilities"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Vulnerabilities | Scout"><meta data-rh="true" name="description" content="This section lists relevant security-related issues typically introduced during the development of smart contracts in Substrate Ink!. While many of these issues can be generalized to Substrate-based networks, that is not always the case. The list, though non-exhaustive, features highly relevant items. Each issue is assigned a severity label based on the taxonomy presented below."><meta data-rh="true" property="og:description" content="This section lists relevant security-related issues typically introduced during the development of smart contracts in Substrate Ink!. While many of these issues can be generalized to Substrate-based networks, that is not always the case. The list, though non-exhaustive, features highly relevant items. Each issue is assigned a severity label based on the taxonomy presented below."><link data-rh="true" rel="icon" href="/scout/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://coinfabrik.github.io/scout/docs/vulnerabilities"><link data-rh="true" rel="alternate" href="https://coinfabrik.github.io/scout/docs/vulnerabilities" hreflang="en"><link data-rh="true" rel="alternate" href="https://coinfabrik.github.io/scout/docs/vulnerabilities" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/scout/blog/rss.xml" title="Scout RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/scout/blog/atom.xml" title="Scout Atom Feed"><link rel="stylesheet" href="/scout/assets/css/styles.489556df.css">
<link rel="preload" href="/scout/assets/js/runtime~main.58d452a3.js" as="script">
<link rel="preload" href="/scout/assets/js/main.872fc589.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_ncxO" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/scout/"><div class="navbar__logo"><img src="/scout/img/logo.svg" alt="Scout Logo" class="themedImage_GG80 themedImage--light_ZgxF"><img src="/scout/img/logo.svg" alt="Scout Logo" class="themedImage_GG80 themedImage--dark_MYOw"></div><b class="navbar__title text--truncate">Scout</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/scout/docs/intro">Docs</a><a href="https://blog.coinfabrik.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/CoinFabrik/scout" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_EDmP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_nHBA colorModeToggle_jEoN"><button class="clean-btn toggleButton_gmen toggleButtonDisabled_Zoqn" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_vSGv"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_JP4D"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_tp3Z"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_fl_v docsWrapper_ytDb"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_fFhq" type="button"></button><div class="docPage_WdUH"><aside class="theme-doc-sidebar-container docSidebarContainer_z7_f"><div class="sidebarViewport_Rl5r"><div class="sidebar_V2Af"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_FhEl"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/scout/docs/intro">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" href="/scout/docs/vulnerabilities">Vulnerabilities</a><button aria-label="Toggle the collapsible sidebar category &#x27;Vulnerabilities&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/integer-overflow-or-underflow">Integer overflow or underflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/set-contract-storage">Set contract storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/reentrancy">Reentrancy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/panic-error">Panic Error</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/unused-return-enum">Unused return enum</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/dos-unbounded-operation">DoS unbounded operation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/dos-unexpected-revert-with-vector">DoS unexpected revert With vector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/unsafe-expect">Unsafe expect</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/unsafe-unwrap">Unsafe unwrap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/divide-before-multiply">Divide before multiply</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/delegate-call">Delegate call</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/zero-or-test-address">Zero or test address</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/insufficiently-random-values">Insufficiently random values</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scout/docs/vulnerabilities/unrestricted-transfer-from">Unrestricted transfer from</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/scout/docs/detectors">Detectors</a><button aria-label="Toggle the collapsible sidebar category &#x27;Detectors&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/scout/docs/contribute">Contribute</a></li></ul></nav></div></div></aside><main class="docMainContainer_Pgl4"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_rctn"><div class="docItemContainer_dEmd"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z9gU" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/scout/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_vGxT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Vulnerabilities</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ZGGv theme-doc-toc-mobile tocMobile_bAIR"><button type="button" class="clean-btn tocCollapsibleButton_VzJ9">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Vulnerabilities</h1><p>This section lists relevant security-related issues typically introduced during the development of smart contracts in Substrate Ink!. While many of these issues can be generalized to Substrate-based networks, that is not always the case. The list, though non-exhaustive, features highly relevant items. Each issue is assigned a severity label based on the taxonomy presented below.</p><h2 class="anchor anchorWithStickyNavbar_FJPA" id="vulnerability-severity">Vulnerability Severity<a href="#vulnerability-severity" class="hash-link" aria-label="Direct link to Vulnerability Severity" title="Direct link to Vulnerability Severity">​</a></h2><p>This severity classification, although arbitrary, has been used in hundreds
of security audits and helps to understand the vulnerabilities we introduce
and measure the utility of this proof of concept.</p><ul><li><strong>Critical</strong>: These issues seriously compromise the system and must be addressed immediately.</li><li><strong>Medium</strong>: These are potentially exploitable issues which might represent
a security risk in the near future. We suggest fixing them as soon as possible.</li><li><strong>Minor</strong>: These issues represent problems that are relatively small or difficult to exploit, but might be exploited in combination with other issues. These kinds of issues do not block deployments in production environments. They should be taken into account and fixed when possible.</li><li><strong>Enhancement</strong>: This class relates to issues stemming from deviations from best practices or stylistic conventions, which could escalate into higher-priority issues due to other changes. For instance, these issues may lead to development errors in future updates.</li></ul><h2 class="anchor anchorWithStickyNavbar_FJPA" id="vulnerability-categories">Vulnerability Categories<a href="#vulnerability-categories" class="hash-link" aria-label="Direct link to Vulnerability Categories" title="Direct link to Vulnerability Categories">​</a></h2><p>We follow with a taxonomy of Vulnerabilities. Many &quot;top vulnerability&quot; lists
can be found covering Ethereum/Solidity smart contracts. This list below is
used by the Coinfabrik Audit Team, when source code (security) audits in
Ethereum/Solidity, Stacks/Clarity, Algorand/PyTEAL /TEAL, Solana/RUST, etc.
The team discusses the creation of the list in this
<a href="https://blog.coinfabrik.com/analysis-categories/" target="_blank" rel="noopener noreferrer">blogpost</a>.</p><table><thead><tr><th>Category</th><th>Description</th></tr></thead><tbody><tr><td>Arithmetic</td><td>Proper usage of arithmetic and number representation.</td></tr><tr><td>Assembly Usage</td><td>Detailed analysis of implementations using assembly.</td></tr><tr><td>Authorization</td><td>Vulnerabilities related to insufficient access control or incorrect authorization implementation.</td></tr><tr><td>Best practices</td><td>Conventions and best practices for improved code quality and vulnerability prevention.</td></tr><tr><td>Block attributes</td><td>Appropriate usage of block attributes, especially when used as a source of randomness.</td></tr><tr><td>Centralization</td><td>Analysis of centralization and single points of failure.</td></tr><tr><td>Denial of Service</td><td>Denial of service. attacks.</td></tr><tr><td>Gas Usage</td><td>Performance issues, enhancements and vulnerabilities related to use of gas.</td></tr><tr><td>MEV</td><td>Patterns that could lead to the exploitation of Maximal Extractable Value.</td></tr><tr><td>Privacy</td><td>Patterns revealing sensible user or state data.</td></tr><tr><td>Reentrancy</td><td>Consistency of contract state under recursive calls.</td></tr><tr><td>Unexpected transfers</td><td>Contract behavior under unexpected or forced transfers of tokens.</td></tr><tr><td>Upgradability</td><td>Proxy patterns and upgradable smart contracts.</td></tr><tr><td>Validations and error handling</td><td>Handling of errors, exceptions and parameters.</td></tr></tbody></table><p>We used the above Vulnerability Categories, along with common examples of vulnerabilities detected within each category in other blockchains, as a guideline for finding and developing vulnerable examples of Substrate Ink! smart contracts.</p><h2 class="anchor anchorWithStickyNavbar_FJPA" id="vulnerability-classes">Vulnerability Classes<a href="#vulnerability-classes" class="hash-link" aria-label="Direct link to Vulnerability Classes" title="Direct link to Vulnerability Classes">​</a></h2><p>As a result of our research, we have so far identified fourteen types of vulnerabilities.</p><p>What follows is a description of each vulnerability in the context of ink! smart contracts. In each case, we have produced at least one <a href="https://github.com/CoinFabrik/scout/tree/main/test-cases" target="_blank" rel="noopener noreferrer">test-case</a> smart contract that exposes one of these vulnerabilities.</p><p>Check our
<a href="https://github.com/CoinFabrik/scout/tree/main/test-cases" target="_blank" rel="noopener noreferrer">test-cases</a>
for code examples of these vulnerabilities and their respective remediations.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="1---integer-overflow-or-underflow">1 - Integer overflow or underflow<a href="#1---integer-overflow-or-underflow" class="hash-link" aria-label="Direct link to 1 - Integer overflow or underflow" title="Direct link to 1 - Integer overflow or underflow">​</a></h3><p>This type of vulnerability occurs when an arithmetic operation attempts to
create a numeric value that is outside the valid range in substrate, e.g,
a <code>u8</code> unsigned integer can be at most <em>M:=2^8-1=255</em>, hence the sum <code>M+1</code>
produces an overflow. </p><p>An overflow/underflow is typically caught and generates an error. When it
is not caught, the operation will result in an inexact result which could
lead to serious problems. </p><p>We classified this type of vulnerability under
the <a href="#vulnerability-categories">Arithmetic</a> category and assigned it a
Critical severity.</p><p>In the context of Substrate, we found that this vulnerability could only be
realized if overflow and underflow checks are disabled during compilation.
Notwithstanding, there are contexts where developers do turn off checks for
valid reasons and hence the reason for including this vulnerability in the
list. </p><p>Check the following <a href="/scout/docs/vulnerabilities/integer-overflow-or-underflow">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="2---set-contract-storage">2 - Set contract storage<a href="#2---set-contract-storage" class="hash-link" aria-label="Direct link to 2 - Set contract storage" title="Direct link to 2 - Set contract storage">​</a></h3><p>Smart contracts can store important information in memory which changes through the contract&#x27;s lifecycle. Changes happen via user interaction with the smart contract. An <em>unauthorized</em> set contract storage vulnerability happens when a smart contract call allows a user to set or modify contract memory when they were not supposed to be authorized.</p><p>Common practice is to have functions with the ability to change
security-relevant values in memory to be only accessible to specific roles,
e.g, only an admin can call the function <code>reset()</code> which resets auction values.
When this does not happen, arbitrary users may alter memory which may impose
great damage to the smart contract users. </p><p>We classified this type of vulnerability under
the <a href="#vulnerability-categories">Authorization</a> category and assigned it a
Critical severity.</p><p>In <code>ink!</code> the function <code>set_contract_storage(key: &amp;K, value: &amp;V)</code> can be used
to modify the contract storage under a given key. When a smart contract uses
this function, the contract needs to check if the caller should be able to
alter this storage. If this does not happen, an arbitary caller may modify
balances and other relevant contract storage.</p><p>Check the following <a href="/scout/docs/vulnerabilities/set-contract-storage">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="3---reentrancy">3 - Reentrancy<a href="#3---reentrancy" class="hash-link" aria-label="Direct link to 3 - Reentrancy" title="Direct link to 3 - Reentrancy">​</a></h3><p>An <code>ink!</code> smart contract can interact with other smart contracts. These
operations imply (external) calls where control flow is passed to the called
contract until the execution of the called code is over, then the control is
delivered back to the caller. A <em>reentrancy</em> vulnerability may happen when a
user calls a function, this function calls a malicious contract which again
calls this same function, and this &#x27;reentrancy&#x27; has unexpected reprecussions
to the contract.</p><p>This kind of attack was used in Ethereum for
<a href="https://www.economist.com/finance-and-economics/2016/05/19/the-dao-of-accrue" target="_blank" rel="noopener noreferrer">the infamous DAO Hack</a>.</p><p>This vulnerability may be prevented with the use of the Check-Effect-Interaction
pattern that dictates that we first evaluate (check) if the necessary conditions
are granted, next we record the effects of the interaction and finally we
execute the interaction (e.g., check if the user has funds, substract the funds
from the records, then transfer the funds). There&#x27;s also so-called
<em>reentrancy guards</em> which prevent the marked piece of code to be called twice
from the same contract call. When the vulnerability may be exercised, the
successive calls to the contract may allow the malicious contract to execute a
function partially many times, e.g., transfering funds many times but
substracting the funds only once. </p><p>We classified this type of vulnerability under
the <a href="#vulnerability-categories">Reentrancy</a> category and assigned it a
Critical severity.</p><p>In the context of <code>ink!</code> Substrate smart contracts there are controls
preventing reentrancy which could be turned off (validly) using the flag
<code>set_allow_reentry(true)</code>.</p><p>Check the following <a href="/scout/docs/vulnerabilities/reentrancy">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="4---panic-error">4 - Panic error<a href="#4---panic-error" class="hash-link" aria-label="Direct link to 4 - Panic error" title="Direct link to 4 - Panic error">​</a></h3><p>The use of the <code>panic!</code> macro to stop execution when a condition is not met is
useful for testing and prototyping but should be avoided in production code.
Using <code>Result</code> as the return type for functions that can fail is the idiomatic
way to handle errors in Rust.</p><p>We classified this issue, a deviation from best practices which could have
security implications, under the <a href="#vulnerability-categories">Validations and error handling</a> category and assigned it an Enhancement severity.</p><p>Check the following <a href="/scout/docs/vulnerabilities/panic-error">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="5---unused-return-enum">5 - Unused return enum<a href="#5---unused-return-enum" class="hash-link" aria-label="Direct link to 5 - Unused return enum" title="Direct link to 5 - Unused return enum">​</a></h3><p><code>Ink!</code> messages can return a <code>Result</code> <code>enum</code> with a custom error type. This is
useful for the caller to know what went wrong when the message fails. The
definition of the <code>Result</code> type enum consists of two variants: Ok and Err. If
any of the variants is not used, the code could be simplified or it could imply
a bug.</p><p>We put this vulnerability under the <a href="#vulnerability-categories">Validations and error handling category</a>
with a Minor Severity.</p><p>In our example, we see how lack of revision on the usage of both types (<code>Ok</code>
and <code>Err</code>) leads to code where its intended functionality is not realized.</p><p>Check the following <a href="/scout/docs/vulnerabilities/unused-return-enum">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="6---dos-unbounded-operation">6 - DoS unbounded operation<a href="#6---dos-unbounded-operation" class="hash-link" aria-label="Direct link to 6 - DoS unbounded operation" title="Direct link to 6 - DoS unbounded operation">​</a></h3><p>Each block in a Substrate Blockchain has an upper bound on the amount of gas
that can be spent, and thus the amount of computation that can be done. This
is the Block Gas Limit. If the gas spent by a function call on an <code>ink!</code> smart
contract exceeds this limit, the transaction will fail. Sometimes it is the
case that the contract logic allows a malicious user to modify conditions
so that other users are forced to exhaust gas on standard function calls.</p><p>In order to prevent a single transaction from consuming all the gas in a block,
unbounded operations must be avoided. This includes loops that do not have a
bounded number of iterations, and recursive calls. </p><p>We classified this type of vulnerability under
the <a href="#vulnerability-categories">Denial of Service</a> category and assigned it a
Medium severity.</p><p>A denial of service vulnerability allows the exploiter to hamper the
availability of a service rendered by the smart contract. In the context
of <code>ink!</code> smart contracts, it can be caused by the exhaustion of gas,
storage space, or other failures in the contract&#x27;s logic.</p><p>Needless to say, there are many different ways to cause a DoS vulnerability.
This case is relevant and introduced repeatedly by the developer untrained in
web3 environments. </p><p>Check the following <a href="/scout/docs/vulnerabilities/dos-unbounded-operation">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="7---dos-unexpected-revert-with-vector">7 - DoS unexpected revert with vector<a href="#7---dos-unexpected-revert-with-vector" class="hash-link" aria-label="Direct link to 7 - DoS unexpected revert with vector" title="Direct link to 7 - DoS unexpected revert with vector">​</a></h3><p>Another type of Denial of Service attack is called unexpected revert. It occurs
by preventing transactions by other users from being successfully executed
forcing the blockchain state to revert to its original state.</p><p>This vulnerability again falls under the <a href="#vulnerability-categories">Denial of Service</a> category
and has a Medium severity.</p><p>In this particular example, a Denial of Service through unexpected revert is
accomplished by exploiting a smart contract that does not manage storage size
errors correctly. It can be prevented by using Mapping instead of Vec to avoid
storage limit problems.</p><p>Check the following <a href="/scout/docs/vulnerabilities/dos-unexpected-revert-with-vector">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="8---unsafe-expect">8 - Unsafe expect<a href="#8---unsafe-expect" class="hash-link" aria-label="Direct link to 8 - Unsafe expect" title="Direct link to 8 - Unsafe expect">​</a></h3><p>In Rust, the <code>expect</code> method is commonly used for error handling. It retrieves the value from a <code>Result</code> or <code>Option</code> and panics with a specified error message if an error occurs. However, using <code>expect</code> can lead to unexpected program crashes.</p><p>This vulnerability falls under the <a href="#vulnerability-categories">Validations and error handling</a> category
and has a Medium severity.</p><p>In our example, we see an exploit scenario involving a contract using the <code>expect</code> method in a function that retrieves the balance of an account. If there is no entry for the account, the contract panics and halts execution, enabling malicious exploitation.</p><p>Check the following <a href="/scout/docs/vulnerabilities/unsafe-expect">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="9---unsafe-unrwap">9 - Unsafe unrwap<a href="#9---unsafe-unrwap" class="hash-link" aria-label="Direct link to 9 - Unsafe unrwap" title="Direct link to 9 - Unsafe unrwap">​</a></h3><p>This vulnerability class pertains to the inappropriate usage of the <code>unwrap</code> method in Rust, which is commonly employed for error handling. The <code>unwrap</code> method retrieves the inner value of an <code>Option</code> or <code>Result</code>, but if an error or <code>None</code> occurs, it triggers a panic and crashes the program.</p><p>This vulnerability again falls under the <a href="#vulnerability-categories">Validations and error handling</a> category and has a Medium severity.</p><p>In our example, we consider an contract that utilizes the <code>unwrap</code> method to retrieve the balance of an account from a mapping. If there is no entry for the specified account, the contract will panic and abruptly halt execution, opening avenues for malicious exploitation.</p><p>Check the following <a href="/scout/docs/vulnerabilities/unsafe-unwrap">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="10---divide-before-multiply">10 - Divide before multiply<a href="#10---divide-before-multiply" class="hash-link" aria-label="Direct link to 10 - Divide before multiply" title="Direct link to 10 - Divide before multiply">​</a></h3><p>This vulnerability class relates to the order of operations in Rust, specifically in integer arithmetic. Performing a division operation before a multiplication can lead to a loss of precision. This issue becomes significant in programs like smart contracts where numerical precision is crucial.</p><p>This vulnerability falls under the <a href="#vulnerability-categories">Arithmetic</a> category
and has a Medium Severity.</p><p>Check the following <a href="/scout/docs/vulnerabilities/divide-before-multiply">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="11---delegate-call">11 - Delegate call<a href="#11---delegate-call" class="hash-link" aria-label="Direct link to 11 - Delegate call" title="Direct link to 11 - Delegate call">​</a></h3><p>Delegate calls can introduce security vulnerabilities if not handled carefully. The main idea is that delegate calls to contracts passed as arguments can be used to change the expected behavior of the contract, leading to potential attacks. It is important to validate and restrict delegate calls to trusted contracts, implement proper access control mechanisms, and carefully review external contracts to prevent unauthorized modifications, unexpected behavior, and potential exploits. By following these best practices, developers can enhance the security of their smart contracts and mitigate the risks associated with delegate calls.</p><p>This vulnerability falls under the <a href="#vulnerability-categories">Authorization</a> category
and has a Critical severity.</p><p>Check the following <a href="/scout/docs/vulnerabilities/delegate-call">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="12---zero-or-test-address">12 - Zero or test address<a href="#12---zero-or-test-address" class="hash-link" aria-label="Direct link to 12 - Zero or test address" title="Direct link to 12 - Zero or test address">​</a></h3><p>The assignment of the zero address to a variable in a smart contract represents a critical vulnerability because it can lead to loss of control over the contract. This stems from the fact that the zero address does not have an associated private key, which means it&#x27;s impossible to claim ownership, rendering any contract assets or functions permanently inaccessible. </p><p>Assigning a test address can also have similar implications, including the loss of access or granting access to a malicious actor if its private keys are not handled with care.</p><p>This vulnerability falls under the <a href="#vulnerability-categories">Validations and error handling</a> category
and has a Medium severity.</p><p>Check the following <a href="/scout/docs/vulnerabilities/zero-or-test-address">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="13---insufficiently-random-values">13 - Insufficiently random values<a href="#13---insufficiently-random-values" class="hash-link" aria-label="Direct link to 13 - Insufficiently random values" title="Direct link to 13 - Insufficiently random values">​</a></h3><p>Using block attributes like <code>block_timestamp</code> or <code>block_number</code> for random number generation in ink! Substrate smart contracts is not recommended due to the predictability of these values. Block attributes are publicly visible and deterministic, making it easy for malicious actors to anticipate their values and manipulate outcomes to their advantage. Furthermore, validators could potentially influence these attributes, further exacerbating the risk of manipulation. For truly random number generation, it&#x27;s important to use a source that is both unpredictable and external to the blockchain environment, reducing the potential for malicious exploitation.</p><p>This vulnerability again falls under the <a href="#vulnerability-categories">Block attributes</a> category
and has a Critical severity.</p><p>Check the following <a href="/scout/docs/vulnerabilities/insufficiently-random-values">documentation</a> for a more detailed explanation of this vulnerability class.</p><h3 class="anchor anchorWithStickyNavbar_FJPA" id="14---unrestricted-transfer-from">14 - Unrestricted transfer from<a href="#14---unrestricted-transfer-from" class="hash-link" aria-label="Direct link to 14 - Unrestricted transfer from" title="Direct link to 14 - Unrestricted transfer from">​</a></h3><p>In an ink! Substrate smart contract, allowing unrestricted <code>transfer_from</code> operations poses a significant vulnerability. When arguments for such functions are provided directly by the user, this might enable the withdrawal of funds from any actor with token approval on the contract. Specifically, a user could pass the address of an actor with approval as an argument to <code>transfer_from</code>, allowing the user to transfer tokens from that actor&#x27;s balance. This could result in unauthorized transfers and loss of funds. To mitigate this vulnerability, instead of allowing an arbitrary from address, the from address should be restricted, ideally to the address of the caller (<code>self.env().caller()</code>), ensuring that only the sender can initiate a transfer.</p><p>This vulnerability falls under the <a href="#vulnerability-categories">Validations and error handling</a> category
and has a Critical severity.</p><p>Check the following <a href="/scout/docs/vulnerabilities/unrestricted-transfer-from">documentation</a> for a more detailed explanation of this vulnerability class.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/CoinFabrik/scout/docs/vulnerabilities/README.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_blsI" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_FXLf"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/scout/docs/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Getting Started</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/scout/docs/vulnerabilities/integer-overflow-or-underflow"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Integer overflow or underflow</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_WyRm thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#vulnerability-severity" class="table-of-contents__link toc-highlight">Vulnerability Severity</a></li><li><a href="#vulnerability-categories" class="table-of-contents__link toc-highlight">Vulnerability Categories</a></li><li><a href="#vulnerability-classes" class="table-of-contents__link toc-highlight">Vulnerability Classes</a><ul><li><a href="#1---integer-overflow-or-underflow" class="table-of-contents__link toc-highlight">1 - Integer overflow or underflow</a></li><li><a href="#2---set-contract-storage" class="table-of-contents__link toc-highlight">2 - Set contract storage</a></li><li><a href="#3---reentrancy" class="table-of-contents__link toc-highlight">3 - Reentrancy</a></li><li><a href="#4---panic-error" class="table-of-contents__link toc-highlight">4 - Panic error</a></li><li><a href="#5---unused-return-enum" class="table-of-contents__link toc-highlight">5 - Unused return enum</a></li><li><a href="#6---dos-unbounded-operation" class="table-of-contents__link toc-highlight">6 - DoS unbounded operation</a></li><li><a href="#7---dos-unexpected-revert-with-vector" class="table-of-contents__link toc-highlight">7 - DoS unexpected revert with vector</a></li><li><a href="#8---unsafe-expect" class="table-of-contents__link toc-highlight">8 - Unsafe expect</a></li><li><a href="#9---unsafe-unrwap" class="table-of-contents__link toc-highlight">9 - Unsafe unrwap</a></li><li><a href="#10---divide-before-multiply" class="table-of-contents__link toc-highlight">10 - Divide before multiply</a></li><li><a href="#11---delegate-call" class="table-of-contents__link toc-highlight">11 - Delegate call</a></li><li><a href="#12---zero-or-test-address" class="table-of-contents__link toc-highlight">12 - Zero or test address</a></li><li><a href="#13---insufficiently-random-values" class="table-of-contents__link toc-highlight">13 - Insufficiently random values</a></li><li><a href="#14---unrestricted-transfer-from" class="table-of-contents__link toc-highlight">14 - Unrestricted transfer from</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/scout/docs/intro">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/scout/docs/vulnerabilities">Vulnerabilities</a></li><li class="footer__item"><a class="footer__link-item" href="/scout/docs/detectors">Detectors</a></li><li class="footer__item"><a class="footer__link-item" href="/scout/docs/contribute">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/coinfabrik?lang=en" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_EDmP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.instagram.com/coinfabrik/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_EDmP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.reddit.com/r/CoinFabrik/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_EDmP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.coinfabrik.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Web Site</a></li><li class="footer__item"><a href="https://blog.coinfabrik.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/CoinFabrik" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_EDmP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Scout, CoinFabrik.</div></div></div></footer></div>
<script src="/scout/assets/js/runtime~main.58d452a3.js"></script>
<script src="/scout/assets/js/main.872fc589.js"></script>
</body>
</html>